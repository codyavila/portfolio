@import "tailwindcss";
@plugin "@tailwindcss/typography";

@variant dark (&:where(.dark, .dark *));

:root {
  /* ═══════════════════════════════════════════════════════════════════════════
     PROJECT LUMINOUS — Design System Tokens v1.0
     "Bioluminescent Material" | Interface as an Organism
     ═══════════════════════════════════════════════════════════════════════════ */

  /* ─────────────────────────────────────────────────────────────────────────────
     LAYER 0: THE VOID (Canvas/Background)
     Purple-tinted darks for warmth and magic. Never pure black.
     ───────────────────────────────────────────────────────────────────────────── */
  --lum-void-deep: #050508;
  --lum-void-surface: #0F1116;
  --lum-void-elevated: #1A1424;
  --lum-void-accent: #241C2E;

  /* ─────────────────────────────────────────────────────────────────────────────
     PLAYFUL GRADIENTS (The Life) — Holographic/Bioluminescent
     Used for buttons, active borders, hero text
     ───────────────────────────────────────────────────────────────────────────── */
  --lum-grad-primary: linear-gradient(135deg, #4F46E5 0%, #06B6D4 100%);
  --lum-grad-secondary: linear-gradient(135deg, #7C3AED 0%, #DB2777 100%);
  --lum-grad-accent: linear-gradient(135deg, #84CC16 0%, #10B981 100%);

  --lum-grad-cyber-lime: var(--lum-grad-accent);
  --lum-grad-cotton-candy: var(--lum-grad-secondary);
  --lum-grad-solar-flare: var(--lum-grad-primary); /* Mapping to primary for now, or keep as is? Spec says Primary is Indigo/Cyan. Solar flare was Yellow/Pink. I'll keep solar flare as is but add the new ones. */
  
  /* Re-defining old ones to match spec where possible or keep them if unique */
  --lum-grad-holographic: linear-gradient(135deg, #ccff00, #00ff99, #33ccff, #ff99cc, #ff3366, #ccff00);
  --lum-grad-aurora: linear-gradient(135deg, #00ff99 0%, #33ccff 50%, #ff99cc 100%);

  /* Neon Color Rails (individual colors) */
  --neon-primary-start: #ccff00;
  --neon-primary-end: #00ff99;
  --neon-secondary-start: #ff99cc;
  --neon-secondary-end: #33ccff;
  --neon-alert-start: #ffcc00;
  --neon-alert-end: #ff3366;
  --neon-cyan: #00ffff;
  --neon-magenta: #ff00ff;
  --neon-lime: #ccff00;

  /* Extended Neon Palette — Semantic Colors */
  --lum-neon-blue: #33ccff;
  --lum-neon-purple: #a855f7;
  --lum-neon-pink: #ff6b9d;
  --lum-neon-green: #00ff99;
  --lum-neon-yellow: #ffcc00;
  --lum-neon-cyan: #00ffff;
  --lum-cotton-candy: #ff99cc;

  /* ─────────────────────────────────────────────────────────────────────────────
     TEXT SYSTEM — High contrast solid colors
     WCAG AA compliant: 4.5:1 for normal text, 3:1 for large text
     ───────────────────────────────────────────────────────────────────────────── */
  --text-primary: #ffffff;
  --text-secondary: #e0dce6;
  --text-tertiary: #b8b2c4;
  --text-disabled: #8a849c;
  --text-glass-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
  --text-glow-primary: 0 0 20px rgba(204, 255, 0, 0.5), 0 0 40px rgba(0, 255, 153, 0.3);
  --text-glow-secondary: 0 0 20px rgba(255, 153, 204, 0.5), 0 0 40px rgba(51, 204, 255, 0.3);

  /* ─────────────────────────────────────────────────────────────────────────────
     GLASS MATERIALS — Optical Density System (Spatial UI Layers)
     Layer 1 (Mist): Secondary containers — Fog
     Layer 2 (Prism): Primary interactive cards — Ice
     Layer 3 (Lume): Modals, Floating Nav — Frosted Glass
     ───────────────────────────────────────────────────────────────────────────── */
  --glass-mist-fill: rgba(255, 255, 255, 0.03);
  --glass-mist-blur: 12px;
  --glass-mist-noise: 0.01;

  --glass-prism-fill: rgba(255, 255, 255, 0.08);
  --glass-prism-blur: 24px;
  --glass-prism-noise: 0.02;

  --glass-lume-fill: rgba(255, 255, 255, 0.15);
  --glass-lume-blur: 48px;
  --glass-lume-noise: 0.03;

  /* ─────────────────────────────────────────────────────────────────────────────
     LEGACY GLASS ALIASES — For backwards compatibility
     ───────────────────────────────────────────────────────────────────────────── */
  --glass-1-fill: var(--glass-mist-fill);
  --glass-1-border: rgba(255, 255, 255, 0.06);
  --glass-1-blur: var(--glass-mist-blur);

  --glass-2-fill: var(--glass-prism-fill);
  --glass-2-border: rgba(255, 255, 255, 0.12);
  --glass-2-blur: var(--glass-prism-blur);

  --glass-3-fill: rgba(255, 255, 255, 0.09);
  --glass-3-border: rgba(255, 255, 255, 0.2);
  --glass-3-blur: 36px;

  --glass-4-fill: var(--glass-lume-fill);
  --glass-4-border: rgba(255, 255, 255, 0.28);
  --glass-4-blur: var(--glass-lume-blur);

  /* ─────────────────────────────────────────────────────────────────────────────
     SPRING PHYSICS — Motion Tokens (No linear ease allowed!)
     ───────────────────────────────────────────────────────────────────────────── */
  --spring-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
  --spring-smooth: cubic-bezier(0.25, 0.8, 0.25, 1);
  --spring-snappy: cubic-bezier(0.2, 0.8, 0.3, 1.2);
  --spring-elastic: cubic-bezier(0.68, -0.55, 0.265, 1.55);

  /* ─────────────────────────────────────────────────────────────────────────────
     CHIP/BADGE BACKGROUNDS — Accessible contrast in both modes
     ───────────────────────────────────────────────────────────────────────────── */
  --chip-primary-bg: rgba(0, 255, 153, 0.15);
  --chip-primary-border: rgba(0, 255, 153, 0.3);
  --chip-primary-text: #00ff99;
  --chip-secondary-bg: rgba(255, 153, 204, 0.15);
  --chip-secondary-border: rgba(255, 153, 204, 0.3);
  --chip-secondary-text: #ff99cc;
  --chip-blue-bg: rgba(51, 204, 255, 0.15);
  --chip-blue-border: rgba(51, 204, 255, 0.3);
  --chip-blue-text: #33ccff;
  --chip-purple-bg: rgba(168, 85, 247, 0.15);
  --chip-purple-border: rgba(168, 85, 247, 0.3);
  --chip-purple-text: #a855f7;

  /* Hover accent color - bright in dark mode */
  --hover-accent: #00ff99;

  /* Base Variables for Theme Provider */
  --background: var(--lum-void-surface);
  --foreground: var(--text-primary);
}

/* ═══════════════════════════════════════════════════════════════════════════════
   LIGHT MODE — Clean, warm, professional
   Using :root:not(.dark) to match next-themes behavior
   ═══════════════════════════════════════════════════════════════════════════════ */
:root:not(.dark),
html:not(.dark) {
  --lum-void-deep: #fafafa;
  --lum-void-surface: #ffffff;
  --lum-void-elevated: #f5f3f7;
  --lum-void-accent: #ebe8ef;

  /* Adjusted neon colors for light mode - WCAG AA compliant (4.5:1+ contrast) */
  --neon-primary-start: #166534;
  --neon-primary-end: #15803d;
  --neon-secondary-start: #9e1b4d;
  --neon-secondary-end: #075985;
  --neon-alert-start: #92400e;
  --neon-alert-end: #991b1b;
  --neon-cyan: #0c6478;
  --neon-magenta: #86198f;
  --neon-lime: #166534;

  --lum-neon-blue: #1e40af;
  --lum-neon-purple: #5b21b6;
  --lum-neon-pink: #9e1b4d;
  --lum-neon-green: #15803d;
  --lum-neon-yellow: #854d0e;
  --lum-neon-cyan: #0c6478;
  --lum-cotton-candy: #9e1b4d;

  /* Light mode gradients - WCAG compliant darker shades */
  --lum-grad-cyber-lime: linear-gradient(135deg, #166534 0%, #15803d 100%);
  --lum-grad-cotton-candy: linear-gradient(135deg, #9e1b4d 0%, #075985 100%);
  --lum-grad-solar-flare: linear-gradient(135deg, #92400e 0%, #991b1b 100%);

  /* Chip backgrounds for light mode - higher contrast */
  --chip-primary-bg: rgba(22, 101, 52, 0.12);
  --chip-primary-border: rgba(22, 101, 52, 0.3);
  --chip-primary-text: #166534;
  --chip-secondary-bg: rgba(158, 27, 77, 0.12);
  --chip-secondary-border: rgba(158, 27, 77, 0.25);
  --chip-secondary-text: #831843;
  --chip-blue-bg: rgba(30, 64, 175, 0.12);
  --chip-blue-border: rgba(30, 64, 175, 0.25);
  --chip-blue-text: #1e3a8a;
  --chip-purple-bg: rgba(91, 33, 182, 0.12);
  --chip-purple-border: rgba(91, 33, 182, 0.25);
  --chip-purple-text: #4c1d95;

  /* Hover accent color - dark in light mode for visibility */
  --hover-accent: #064e3b;

  /* Text for light mode - WCAG AA compliant contrast ratios */
  --text-primary: #09070c;
  --text-secondary: #2d2834;
  --text-tertiary: #454050;
  --text-disabled: #6b657a;
  --text-glass-shadow: none;
  --text-glow-primary: none;
  --text-glow-secondary: none;

  /* Glass materials for light mode - more opaque for better text legibility */
  --glass-ghost-fill: rgba(255, 255, 255, 0.94);
  --glass-ghost-blur: 8px;
  --glass-prism-fill: rgba(255, 255, 255, 0.97);
  --glass-prism-blur: 12px;
  --glass-lume-fill: rgba(255, 255, 255, 0.99);
  --glass-lume-blur: 16px;

  --glass-1-fill: rgba(255, 255, 255, 0.94);
  --glass-1-border: rgba(0, 0, 0, 0.08);
  --glass-2-fill: rgba(255, 255, 255, 0.97);
  --glass-2-border: rgba(0, 0, 0, 0.10);
  --glass-3-fill: rgba(255, 255, 255, 0.98);
  --glass-3-border: rgba(0, 0, 0, 0.12);
  --glass-4-fill: rgba(255, 255, 255, 0.99);
  --glass-4-border: rgba(0, 0, 0, 0.14);

  --background: #fafafa;
  --foreground: var(--text-primary);
}

.dark {
  --background: var(--lum-void-surface);
  --foreground: var(--text-primary);
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  
  --color-void: var(--lum-void-deep);
  --color-deep-space: var(--lum-void-surface);
  
  --color-neon-primary-start: var(--neon-primary-start);
  --color-neon-primary-end: var(--neon-primary-end);
  --color-neon-secondary-start: var(--neon-secondary-start);
  --color-neon-secondary-end: var(--neon-secondary-end);
  
  --color-text-primary: var(--text-primary);
  --color-text-secondary: var(--text-secondary);
  --color-text-disabled: var(--text-disabled);

  --font-sans: var(--font-inter), ui-sans-serif, system-ui, sans-serif;
  --font-mono: var(--font-jetbrains-mono), ui-monospace, SFMono-Regular, monospace;

  --animate-spotlight: spotlight 2s ease .75s 1 forwards;
  --animate-gradient-xy: gradient-xy 18s ease infinite;
  --animate-heartbeat: heartbeat 4s ease-in-out infinite;

  @keyframes spotlight {
    0% {
      opacity: 0;
      transform: translate(-72%, -62%) scale(0.5);
    }
    100% {
      opacity: 1;
      transform: translate(-50%,-40%) scale(1);
    }
  }

  @keyframes gradient-xy {
    0%, 100% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
  }

  @keyframes heartbeat {
    0%, 100% { opacity: 0.9; transform: scale(1); }
    40% { opacity: 1; transform: scale(1.015); }
    60% { opacity: 0.95; transform: scale(0.995); }
  }

  @keyframes shimmer-border {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }

  @keyframes pulse-glow {
    0%, 100% { box-shadow: 0 0 20px rgba(0, 255, 153, 0.4); }
    50% { box-shadow: 0 0 40px rgba(0, 255, 153, 0.7); }
  }

  @keyframes morph {
    0%, 100% { border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; }
    50% { border-radius: 30% 60% 70% 40% / 50% 60% 30% 60%; }
  }
}

/* ═══════════════════════════════════════════════════════════════════════════════
   GLOBAL STYLES — Interface as an Organism
   ═══════════════════════════════════════════════════════════════════════════════ */

/* iOS Safari Viewport Fix
   Uses dvh (dynamic viewport height) which accounts for the dynamic toolbar.
   Falls back to -webkit-fill-available, then 100vh for older browsers. */
html {
  height: 100%;
  /* Prevent iOS Safari bounce/overscroll from showing white gaps */
  overscroll-behavior: none;
}

body {
  color: var(--text-primary);
  font-family: var(--font-sans);
  overflow-x: hidden;
  /* iOS Safari viewport height fix - cascade of fallbacks */
  min-height: 100vh;
  min-height: -webkit-fill-available;
  min-height: 100dvh;
  position: relative;
  background: transparent !important;
  /* Extend background color into safe areas on iOS */
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
}

.lum-background {
  position: fixed;
  /* Extend beyond viewport to cover iOS Safari chrome areas */
  top: -10vh;
  left: -10vw;
  right: -10vw;
  bottom: -10vh;
  width: 120vw;
  height: 120vh;
  z-index: -20;
  transition: background 0.4s ease;
  /* Light mode default background */
  background: linear-gradient(180deg, #fafafa 0%, #f5f3f7 100%) !important;
}

/* Dark mode background - using .dark class on html */
html.dark .lum-background,
.dark .lum-background {
  background: radial-gradient(ellipse at 20% 0%, var(--bg-surface) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 20%, var(--bg-surface) 0%, transparent 40%),
    radial-gradient(ellipse at 40% 80%, var(--bg-surface) 0%, transparent 50%),
    var(--bg-deep) !important;
  transition: background 1s ease-in-out;
}

/* Prevent backdrop-filter flash during animations */
.glass-card {
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
  isolation: isolate;
}

/* High contrast backgrounds */
html.dark[data-contrast="high"] .lum-background,
.dark[data-contrast="high"] .lum-background {
  background: #000000 !important;
}

html:not(.dark)[data-contrast="high"] .lum-background {
  background: #ffffff !important;
}

/* Noise Texture - reduced in light mode */
/* body::before removed in favor of .noise-overlay */

/* High Contrast Mode — Dark (WCAG AAA: 7:1 contrast) */
.dark[data-contrast="high"] {
  --background: #000000;
  --foreground: #ffffff;
  --text-primary: #ffffff;
  --text-secondary: #f0f0f0;
  --text-tertiary: #e0e0e0;
  --text-disabled: #a0a0a0;
  
  /* Void/Background */
  --lum-void-deep: #000000;
  --lum-void-surface: #000000;
  --lum-void-elevated: #0a0a0a;
  --lum-void-accent: #141414;
  
  /* Glass materials - solid backgrounds for clarity */
  --glass-ghost-fill: rgba(0, 0, 0, 0.95);
  --glass-prism-fill: rgba(0, 0, 0, 0.95);
  --glass-lume-fill: rgba(10, 10, 10, 0.98);
  --glass-ghost-blur: 0px;
  --glass-prism-blur: 0px;
  --glass-lume-blur: 0px;
  --glass-1-fill: rgba(0, 0, 0, 0.95);
  --glass-2-fill: rgba(0, 0, 0, 0.95);
  --glass-3-fill: rgba(10, 10, 10, 0.98);
  --glass-4-fill: rgba(10, 10, 10, 0.98);
  --glass-1-blur: 0px;
  --glass-2-blur: 0px;
  --glass-3-blur: 0px;
  --glass-4-blur: 0px;
  
  /* High contrast borders - bright cyan */
  --glass-1-border: #00ffff;
  --glass-2-border: #00ffff;
  --glass-3-border: #00ffff;
  --glass-4-border: #00ffff;
  
  /* Neon colors - maximum brightness */
  --neon-primary-start: #ffff00;
  --neon-primary-end: #00ff00;
  --neon-secondary-start: #ff00ff;
  --neon-secondary-end: #00ffff;
  --hover-accent: #00ff00;
  
  /* Chip styles - high contrast */
  --chip-primary-bg: rgba(0, 255, 0, 0.2);
  --chip-primary-border: #00ff00;
  --chip-primary-text: #00ff00;
  --chip-secondary-bg: rgba(255, 0, 255, 0.2);
  --chip-secondary-border: #ff00ff;
  --chip-secondary-text: #ff00ff;
  --chip-blue-bg: rgba(0, 255, 255, 0.2);
  --chip-blue-border: #00ffff;
  --chip-blue-text: #00ffff;
  --chip-purple-bg: rgba(200, 100, 255, 0.2);
  --chip-purple-border: #c864ff;
  --chip-purple-text: #c864ff;
  
  /* Disable glow effects for clarity */
  --text-glow-primary: none;
  --text-glow-secondary: none;
}

/* High Contrast Mode — Light (WCAG AAA: 7:1 contrast) */
html:not(.dark)[data-contrast="high"] {
  --background: #ffffff;
  --foreground: #000000;
  --text-primary: #000000;
  --text-secondary: #1a1a1a;
  --text-tertiary: #333333;
  --text-disabled: #666666;
  
  /* Void/Background */
  --lum-void-deep: #ffffff;
  --lum-void-surface: #ffffff;
  --lum-void-elevated: #f5f5f5;
  --lum-void-accent: #eeeeee;
  
  /* Glass materials - solid backgrounds for clarity */
  --glass-ghost-fill: rgba(255, 255, 255, 0.98);
  --glass-prism-fill: rgba(255, 255, 255, 0.98);
  --glass-lume-fill: rgba(255, 255, 255, 1);
  --glass-ghost-blur: 0px;
  --glass-prism-blur: 0px;
  --glass-lume-blur: 0px;
  --glass-1-fill: rgba(255, 255, 255, 0.98);
  --glass-2-fill: rgba(255, 255, 255, 0.98);
  --glass-3-fill: rgba(255, 255, 255, 1);
  --glass-4-fill: rgba(255, 255, 255, 1);
  --glass-1-blur: 0px;
  --glass-2-blur: 0px;
  --glass-3-blur: 0px;
  --glass-4-blur: 0px;
  
  /* High contrast borders - pure black */
  --glass-1-border: #000000;
  --glass-2-border: #000000;
  --glass-3-border: #000000;
  --glass-4-border: #000000;
  
  /* Neon colors - dark for contrast on white */
  --neon-primary-start: #006600;
  --neon-primary-end: #004400;
  --neon-secondary-start: #660066;
  --neon-secondary-end: #004466;
  --hover-accent: #004400;
  
  /* Chip styles - high contrast */
  --chip-primary-bg: rgba(0, 100, 0, 0.15);
  --chip-primary-border: #004400;
  --chip-primary-text: #004400;
  --chip-secondary-bg: rgba(100, 0, 100, 0.15);
  --chip-secondary-border: #660066;
  --chip-secondary-text: #660066;
  --chip-blue-bg: rgba(0, 50, 100, 0.15);
  --chip-blue-border: #003366;
  --chip-blue-text: #003366;
  --chip-purple-bg: rgba(75, 0, 130, 0.15);
  --chip-purple-border: #4b0082;
  --chip-purple-text: #4b0082;
  
  /* Disable glow effects for clarity */
  --text-glow-primary: none;
  --text-glow-secondary: none;
}

/* High Contrast — Disable decorative effects */
[data-contrast="high"] .shimmer-border-layer,
[data-contrast="high"] .shimmer-border-layer-secondary,
[data-contrast="high"] .iridescent-layer,
[data-contrast="high"] .iridescent-fresnel,
[data-contrast="high"] .chroma-red,
[data-contrast="high"] .chroma-cyan,
[data-contrast="high"] .chroma-green {
  display: none !important;
}

[data-contrast="high"] .glass-noise::after {
  display: none !important;
}

/* High Contrast — Ensure focus states are visible */
[data-contrast="high"] *:focus-visible {
  outline: 3px solid currentColor !important;
  outline-offset: 2px !important;
}

/* High Contrast — Increase border widths */
[data-contrast="high"] .prism-card,
[data-contrast="high"] .nano-card,
[data-contrast="high"] .portal-card {
  border-width: 2px !important;
}

/* High Contrast — Disable backdrop blur (causes readability issues) */
[data-contrast="high"] .glass-1,
[data-contrast="high"] .glass-2,
[data-contrast="high"] .glass-3,
[data-contrast="high"] .glass-4 {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}

/* ─────────────────────────────────────────────────────────────────────────────
   TYPOGRAPHY — Variable Personality with "Weight Shift"
   Headlines are tight (-0.04em), Body is loose (0.01em)
   ───────────────────────────────────────────────────────────────────────────── */
h1, h2, h3, h4, h5, h6 {
  font-weight: 700;
  line-height: 1.1;
  letter-spacing: -0.04em;
  transition: font-weight 0.35s var(--spring-smooth), 
              letter-spacing 0.35s var(--spring-smooth),
              text-shadow 0.35s var(--spring-smooth);
}

/* Weight Shift on hover — 700 → 850 */
h1:hover, h2:hover, h3:hover {
  font-weight: 850;
  letter-spacing: -0.035em;
}

/* Hover weight shift utility class */
.hover-weight-shift {
  transition: font-weight 0.35s var(--spring-smooth);
}
.hover-weight-shift:hover {
  font-weight: 850;
}

p {
  line-height: 1.6;
  color: var(--text-secondary);
  letter-spacing: 0.01em;
}

/* Text glow effect */
.text-glow {
  text-shadow: var(--text-glow-primary);
}

.text-glow-secondary {
  text-shadow: var(--text-glow-secondary);
}

/* Glass legibility */
.on-glass {
  text-shadow: var(--text-glass-shadow);
}

/* Glass Utilities */
.glass-0 {
  background: transparent;
  backdrop-filter: none;
  border: none;
}

.glass-1 {
  background: var(--glass-1-fill);
  backdrop-filter: blur(var(--glass-1-blur));
  border: 1px solid var(--glass-1-border);
}

.glass-2 {
  background: var(--glass-2-fill);
  backdrop-filter: blur(var(--glass-2-blur));
  border: 1px solid var(--glass-2-border);
}

.glass-3 {
  background: var(--glass-3-fill);
  backdrop-filter: blur(var(--glass-3-blur));
  border: 1px solid var(--glass-3-border);
}

.glass-4 {
  background: var(--glass-4-fill);
  backdrop-filter: blur(var(--glass-4-blur));
  border: 1px solid var(--glass-4-border);
}

/* Glass with noise texture overlay (per Luminous spec: 2-5% noise) */
.glass-noise {
  position: relative;
}

.glass-noise::after {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  opacity: var(--glass-noise-opacity, 0.03);
  mix-blend-mode: overlay;
  pointer-events: none;
}

/* Noise intensity variants */
.glass-noise-ghost { --glass-noise-opacity: 0.02; }
.glass-noise-prism { --glass-noise-opacity: 0.04; }
.glass-noise-lume { --glass-noise-opacity: 0.05; }

/* ─────────────────────────────────────────────────────────────────────────────
   PORTAL CARD — Glass-Prism Material with Shimmer Border
   ───────────────────────────────────────────────────────────────────────────── */
.prism-card {
  position: relative;
  --card-radius: 24px;
  background: var(--glass-prism-fill);
  backdrop-filter: blur(var(--glass-prism-blur));
  border-radius: var(--card-radius);
  border: 1px solid var(--glass-2-border);
  
  /* Light mode: solid white with subtle shadow for depth */
  box-shadow: 
    0 4px 6px -1px rgba(0, 0, 0, 0.08),
    0 2px 4px -2px rgba(0, 0, 0, 0.05);
    
  transition: box-shadow 0.4s var(--spring-smooth), border-color 0.3s ease;
}

/* Dark mode specific card styling */
html.dark .prism-card {
  background: linear-gradient(
    145deg, 
    rgba(255,255,255,0.05) 0%, 
    rgba(255,255,255,0.01) 100%
  );
  box-shadow: 
    inset 0 1px 0 0 rgba(255, 255, 255, 0.1),
    0 20px 40px -10px rgba(0,0,0,0.4);
}

/* Hover states */
.prism-card:hover {
  border-color: var(--neon-primary-end);
  box-shadow: 
    0 10px 25px -5px rgba(0, 0, 0, 0.1),
    0 8px 10px -6px rgba(0, 0, 0, 0.05);
}

html.dark .prism-card:hover {
  box-shadow: 
    inset 0 1px 0 0 rgba(255, 255, 255, 0.2),
    0 25px 50px -12px rgba(0,0,0,0.5),
    0 0 30px -10px rgba(0, 255, 153, 0.15);
}

/* Nano-card specific styling - smaller, more compact */
.nano-card {
  --card-radius: 20px;
  border-radius: var(--card-radius);
}

.nano-card .card-content {
  padding: 1.25rem;
}

html.dark .nano-card {
  background: linear-gradient(
    155deg, 
    rgba(255,255,255,0.045) 0%, 
    rgba(255,255,255,0.015) 100%
  );
}

html.dark .nano-card:hover {
  box-shadow: 
    inset 0 1px 0 0 rgba(255, 255, 255, 0.25),
    0 20px 40px -10px rgba(0,0,0,0.5),
    0 0 40px -12px rgba(0, 255, 153, 0.2);
}

/* Portal card - uses rounded-3xl from Tailwind (24px) */
.portal-card {
  --card-radius: 24px;
}

/* Glow variants based on category color - dark mode only */
html.dark .prism-card.glow-cyber-lime:hover {
  box-shadow: 
    inset 0 1px 0 0 rgba(255, 255, 255, 0.5),
    inset 0 0 20px rgba(204, 255, 0, 0.1),
    0 30px 60px -12px rgba(0,0,0,0.6),
    0 0 50px -10px rgba(204, 255, 0, 0.4);
}

html.dark .prism-card.glow-cotton-candy:hover {
  box-shadow: 
    inset 0 1px 0 0 rgba(255, 255, 255, 0.5),
    inset 0 0 20px rgba(255, 153, 204, 0.1),
    0 30px 60px -12px rgba(0,0,0,0.6),
    0 0 50px -10px rgba(255, 153, 204, 0.4);
}

html.dark .prism-card.glow-solar-flare:hover {
  box-shadow: 
    inset 0 1px 0 0 rgba(255, 255, 255, 0.5),
    inset 0 0 20px rgba(255, 204, 0, 0.1),
    0 30px 60px -12px rgba(0,0,0,0.6),
    0 0 50px -10px rgba(255, 204, 0, 0.4);
}

/* ─────────────────────────────────────────────────────────────────────────────
   SHIMMER BORDER — Rotating gradient border (endless rotation per spec)
   The border rotates around the card continuously at slow speed
   NOTE: Uses a child element approach to avoid ::before/::after conflicts
   ───────────────────────────────────────────────────────────────────────────── */
.shimmer-border {
  position: relative;
  --shimmer-speed: 8s;
}

/* Shimmer border layer - injected via JS in components */
.shimmer-border-layer {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: var(--card-radius, 24px);
  background: conic-gradient(
    from var(--shimmer-angle, 0deg),
    rgba(204, 255, 0, 0.4),
    rgba(0, 255, 153, 0.3),
    rgba(51, 204, 255, 0.4),
    rgba(255, 153, 204, 0.3),
    rgba(255, 51, 102, 0.3),
    rgba(204, 255, 0, 0.4)
  );
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  padding: 1px;
  animation: shimmer-rotate var(--shimmer-speed) linear infinite;
  pointer-events: none;
  z-index: 1;
  opacity: 0.4;
  transition: opacity 0.4s var(--spring-smooth);
}

html.dark .shimmer-border:hover .shimmer-border-layer {
  opacity: 1;
  --shimmer-speed: 4s; /* Speed up on hover */
}

/* Secondary shimmer layer for depth - also injected via JS */
.shimmer-border-layer-secondary {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: var(--card-radius, 24px);
  background: conic-gradient(
    from calc(var(--shimmer-angle, 0deg) + 180deg),
    transparent,
    rgba(255, 255, 255, 0.1),
    transparent,
    rgba(255, 255, 255, 0.05),
    transparent
  );
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  padding: 2px;
  animation: shimmer-rotate var(--shimmer-speed) linear infinite reverse;
  pointer-events: none;
  z-index: 1;
  opacity: 0;
  transition: opacity 0.4s var(--spring-smooth);
}

html.dark .shimmer-border:hover .shimmer-border-layer-secondary {
  opacity: 0.6;
}

@keyframes shimmer-rotate {
  from { --shimmer-angle: 0deg; }
  to { --shimmer-angle: 360deg; }
}

/* Fallback for browsers without @property support */
@supports not (background: conic-gradient(red, blue)) {
  html.dark .shimmer-border::before {
    background: linear-gradient(
      135deg, 
      rgba(204, 255, 0, 0.3), 
      rgba(0, 255, 153, 0.2), 
      rgba(51, 204, 255, 0.3), 
      rgba(255, 153, 204, 0.2),
      rgba(204, 255, 0, 0.3)
    );
    background-size: 200% 200%;
    animation: shimmer-move 8s ease infinite;
  }
}

@keyframes shimmer-move {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* CSS @property for animatable custom property */
@property --shimmer-angle {
  syntax: '<angle>';
  initial-value: 0deg;
  inherits: false;
}

/* ─────────────────────────────────────────────────────────────────────────────
   JELLY / HEARTBEAT — Living breathing components
   ───────────────────────────────────────────────────────────────────────────── */
.heartbeat {
  animation: var(--animate-heartbeat);
}

/* Jelly button squish effect */
.jelly-squish:active {
  transform: scale(0.95) scaleX(1.08);
  transition: transform 80ms var(--spring-elastic);
}

/* ─────────────────────────────────────────────────────────────────────────────
   CURSOR MAGNETISM — Interactive elements attract cursor
   ───────────────────────────────────────────────────────────────────────────── */
.magnetic {
  transition: transform 0.3s var(--spring-snappy);
}

/* ─────────────────────────────────────────────────────────────────────────────
   SQUISH SCROLL — Resistance at scroll boundaries
   ───────────────────────────────────────────────────────────────────────────── */
.squish-scroll {
  overscroll-behavior: contain;
}

.squish-scroll:active {
  transform: scaleY(0.99);
  transition: transform 180ms var(--spring-snappy);
}

/* ─────────────────────────────────────────────────────────────────────────────
   FLOATING BLOB NAVIGATION
   ───────────────────────────────────────────────────────────────────────────── */
.floating-blob {
  background: var(--glass-lume-fill);
  backdrop-filter: blur(var(--glass-lume-blur));
  box-shadow: 
    0 20px 50px -18px rgba(0,0,0,0.65),
    inset 0 1px 0 0 rgba(255, 255, 255, 0.2);
}

/* ─────────────────────────────────────────────────────────────────────────────
   ACCESSIBILITY — Prefer Reduced Motion & High Contrast
   ───────────────────────────────────────────────────────────────────────────── */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.001ms !important;
  }
  .heartbeat { animation: none; }
  .shimmer-border::before { animation: none; }
  .prism-card:hover { transform: none; }
}

/* Entry animation stagger delays */
.stagger-1 { animation-delay: 0ms; }
.stagger-2 { animation-delay: 50ms; }
.stagger-3 { animation-delay: 100ms; }
.stagger-4 { animation-delay: 150ms; }
.stagger-5 { animation-delay: 200ms; }
.stagger-6 { animation-delay: 250ms; }
.stagger-7 { animation-delay: 300ms; }
.stagger-8 { animation-delay: 350ms; }

/* ─────────────────────────────────────────────────────────────────────────────
   TYPOGRAPHY SCALE — Luminous Type System
   Headlines tight (-0.04em), Body loose (0.01em)
   ───────────────────────────────────────────────────────────────────────────── */
.text-display-xl {
  font-size: clamp(3rem, 8vw, 5.5rem);
  line-height: 1;
  letter-spacing: -0.04em;
}

.text-display-l {
  font-size: clamp(2rem, 5vw, 3.5rem);
  line-height: 1.1;
  letter-spacing: -0.035em;
}

.text-display-m {
  font-size: clamp(1.75rem, 4vw, 2.5rem);
  line-height: 1.15;
  letter-spacing: -0.03em;
}

.text-display-s {
  font-size: clamp(1.5rem, 3vw, 2rem);
  line-height: 1.2;
  letter-spacing: -0.025em;
}

.text-title-l {
  font-size: clamp(1.375rem, 2.5vw, 1.75rem);
  line-height: 1.2;
  letter-spacing: -0.025em;
}

.text-title-m {
  font-size: clamp(1.125rem, 2vw, 1.375rem);
  line-height: 1.25;
  letter-spacing: -0.02em;
}

.text-title-s {
  font-size: 1rem;
  line-height: 1.3;
  letter-spacing: -0.015em;
}

.text-body-l {
  font-size: 1.125rem;
  line-height: 1.6;
  letter-spacing: 0.01em;
}

.text-body-m {
  font-size: 1rem;
  line-height: 1.6;
  letter-spacing: 0.01em;
}

.text-body-s {
  font-size: 0.875rem;
  line-height: 1.5;
  letter-spacing: 0.01em;
}

.text-label-s {
  font-size: 0.75rem;
  line-height: 1.4;
  letter-spacing: 0.02em;
  text-transform: uppercase;
}

.text-label-m {
  font-size: 0.8125rem;
  line-height: 1.4;
  letter-spacing: 0.015em;
}

/* ─────────────────────────────────────────────────────────────────────────────
   CHROMATIC ABERRATION — RGB split on glass edges mimicking light dispersion
   Luminous spec: 2px RGB channel separation at edges
   NOTE: Uses child elements to avoid ::before/::after conflicts
   ───────────────────────────────────────────────────────────────────────────── */
.chromatic-edge {
  position: relative;
  /* CSS custom property for dynamic offset */
  --chroma-offset: 1px;
}

.chromatic-edge:hover {
  --chroma-offset: 2px;
}

/* Red channel - offset top-left - use child element */
.chroma-red {
  position: absolute;
  inset: calc(-1 * var(--chroma-offset, 1px));
  border-radius: var(--card-radius, 24px);
  border: 1px solid transparent;
  background: linear-gradient(135deg, rgba(255, 0, 50, 0.2), transparent 50%) border-box;
  -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
  mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
  opacity: 0;
  transform: translate(calc(-1 * var(--chroma-offset, 1px)), calc(-1 * var(--chroma-offset, 1px)));
  transition: 
    opacity 0.4s var(--spring-smooth),
    transform 0.4s var(--spring-smooth);
}

/* Cyan/Blue channel - offset bottom-right - use child element */
.chroma-cyan {
  position: absolute;
  inset: calc(-1 * var(--chroma-offset, 1px));
  border-radius: var(--card-radius, 24px);
  border: 1px solid transparent;
  background: linear-gradient(315deg, rgba(0, 150, 255, 0.2), transparent 50%) border-box;
  -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
  mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
  opacity: 0;
  transform: translate(var(--chroma-offset, 1px), var(--chroma-offset, 1px));
  transition: 
    opacity 0.4s var(--spring-smooth),
    transform 0.4s var(--spring-smooth);
}

html.dark .chromatic-edge:hover .chroma-red,
html.dark .chromatic-edge:hover .chroma-cyan {
  opacity: 1;
}

/* Additional green channel for full RGB dispersion */
.chroma-green {
  position: absolute;
  inset: 0;
  border-radius: var(--card-radius, 24px);
  box-shadow: 0 0 0 1px rgba(0, 255, 100, 0.1);
  opacity: 0;
  transition: opacity 0.4s var(--spring-smooth);
  pointer-events: none;
}

html.dark .chromatic-edge:hover .chroma-green {
  opacity: 1;
}

/* ─────────────────────────────────────────────────────────────────────────────
   IRIDESCENCE — Oil-slick rainbow at glancing angles (Fresnel effect)
   Visible only at edge angles, simulating real glass light dispersion
   NOTE: Uses child elements to avoid ::before/::after conflicts
   ───────────────────────────────────────────────────────────────────────────── */
.iridescent {
  position: relative;
  --iridescent-angle: 135deg;
}

/* Iridescent sweep layer - child element */
.iridescent-layer {
  position: absolute;
  inset: 0;
  border-radius: var(--card-radius, 24px);
  background: 
    /* Primary holographic sweep */
    linear-gradient(
      var(--iridescent-angle, 135deg),
      rgba(255, 0, 128, 0.0) 0%,
      rgba(255, 0, 128, 0.08) 15%,
      rgba(0, 255, 255, 0.06) 30%,
      rgba(255, 255, 0, 0.04) 45%,
      rgba(128, 0, 255, 0.06) 60%,
      rgba(0, 255, 153, 0.08) 75%,
      rgba(255, 0, 128, 0.0) 100%
    );
  background-size: 300% 300%;
  animation: iridescent-sweep 15s ease-in-out infinite;
  pointer-events: none;
  opacity: 0;
  mix-blend-mode: screen;
  transition: opacity 0.6s var(--spring-smooth);
  z-index: 2;
}

/* Fresnel edge glow - more visible at card edges - child element */
.iridescent-fresnel {
  position: absolute;
  inset: 0;
  border-radius: var(--card-radius, 24px);
  background: radial-gradient(
    ellipse 80% 50% at 50% 0%,
    rgba(255, 255, 255, 0.1) 0%,
    transparent 60%
  );
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.6s var(--spring-smooth);
  z-index: 2;
}

html.dark .iridescent:hover .iridescent-layer {
  opacity: 1;
}

html.dark .iridescent:hover .iridescent-fresnel {
  opacity: 0.6;
}

@keyframes iridescent-sweep {
  0%, 100% { 
    background-position: 0% 50%;
    --iridescent-angle: 135deg;
  }
  25% { background-position: 50% 0%; }
  50% { 
    background-position: 100% 50%;
    --iridescent-angle: 225deg;
  }
  75% { background-position: 50% 100%; }
}

/* ─────────────────────────────────────────────────────────────────────────────
   ENHANCED REDUCED MOTION — Comprehensive accessibility
   ───────────────────────────────────────────────────────────────────────────── */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.001ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.15s !important;
    scroll-behavior: auto !important;
  }
  
  .heartbeat,
  .shimmer-border::before,
  .iridescent::before { 
    animation: none !important; 
  }
  
  /* Disable 3D transforms */
  .prism-card:hover,
  .portal-card:hover {
    transform: none !important;
  }
  
  /* Use opacity changes instead of motion */
  .prism-card:hover,
  .portal-card:hover {
    opacity: 0.95;
  }

  /* Simpler hover states */
  h1:hover, h2:hover, h3:hover {
    font-weight: 700;
  }
}

/* ─────────────────────────────────────────────────────────────────────────────
   GLOBAL NOISE OVERLAY — Texture unification
   ───────────────────────────────────────────────────────────────────────────── */
.noise-overlay {
  position: fixed;
  /* Extend beyond viewport to cover iOS Safari chrome areas */
  top: -10vh;
  left: -10vw;
  width: 120vw;
  height: 120vh;
  pointer-events: none;
  z-index: 9999;
  opacity: 0.035;
  /* SVG Noise Data URI - Increased baseFrequency for finer grain */
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
  background-size: 128px 128px; /* Scale down for finer texture */
  animation: noiseShift 1s steps(10) infinite; /* Slower, film-like framerate */
}

/* .vignette removed in favor of DynamicVignette component */

@keyframes noiseShift {
  0% { background-position: 0 0; }
  10% { background-position: -5% -10%; }
  20% { background-position: -15% 5%; }
  30% { background-position: 7% -25%; }
  40% { background-position: 20% 25%; }
  50% { background-position: -25% 10%; }
  60% { background-position: 15% 5%; }
  70% { background-position: 0% 15%; }
  80% { background-position: 25% 35%; }
  90% { background-position: -10% 10%; }
  100% { background-position: 0 0; }
}

/* ─────────────────────────────────────────────────────────────────────────────
   PROSE CUSTOMIZATION — Typography overrides
   ───────────────────────────────────────────────────────────────────────────── */
.prose {
  --tw-prose-body: var(--text-secondary);
  --tw-prose-headings: var(--text-primary);
  --tw-prose-links: var(--neon-primary-end);
  --tw-prose-bold: var(--text-primary);
  --tw-prose-counters: var(--neon-primary-end);
  --tw-prose-bullets: var(--neon-primary-end);
  --tw-prose-hr: var(--glass-2-border);
  --tw-prose-quotes: var(--text-tertiary);
  --tw-prose-quote-borders: var(--neon-primary-end);
  --tw-prose-captions: var(--text-tertiary);
  --tw-prose-code: var(--text-primary);
  --tw-prose-pre-code: var(--text-secondary);
  --tw-prose-pre-bg: var(--lum-void-elevated);
  --tw-prose-th-borders: var(--glass-2-border);
  --tw-prose-td-borders: var(--glass-1-border);
}

/* Custom Bullet Styling */
.prose ul > li {
  position: relative;
  padding-left: 0.5em;
}

.prose ul > li::marker {
  color: var(--neon-primary-end);
}

/* Custom Link Styling */
.prose a {
  text-decoration: none;
  background-image: linear-gradient(to right, var(--neon-primary-end), var(--neon-secondary-end));
  background-size: 0% 2px;
  background-position: 0 100%;
  background-repeat: no-repeat;
  transition: background-size 0.3s var(--spring-smooth), color 0.3s ease;
}

.prose a:hover {
  background-size: 100% 2px;
  color: var(--neon-primary-end);
}

